<html>

<head>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.6.2/joint.css" />
</head>

<body>
    <div id="myholder"></div>

    <div id="myholder"></div>

    <!---dependencies-->
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="node_modules/lodash/lodash.js"></script>
    <script src="node_modules/backbone/backbone.js"></script>
    <script src="node_modules/jointjs/dist/joint.js"></script>

    <script type="text/javascript">

        var namespace = joint.shapes
        var graph = new joint.dia.Graph({}, { cellNamespace: namespace });

        var paper = new joint.dia.Paper({
            el: document.getElementById('myholder'),
            model: graph,
            width: 1280,
            height: 720,
            gridSize: 10,
            drawGrid: true,
            background: {
                color: "rgba(140,59,110,0.3)"
            },
            cellViewNamespace: namespace
        });

        var CustomElement = joint.dia.Element.define('examples.CustomElement', {
            attrs: {
                body: {
                    width: 'calc(w)',
                    height: 'calc(h)',
                    strokeWidth: 2,
                    stroke: 'black',
                    fill: 'white'
                },
                label: {
                    textVerticalAnchor: 'middle',
                    textAnchor: 'middle',
                    x: 'calc(0.5*w)',
                    y: 'calc(0.5*h)',
                    fontSize: 14,
                    fill: 'black'
                },
                button: {
                    cursor: 'pointer',
                    ref: 'buttonLabel',
                    width: 'calc(1.5*w)',
                    height: 'calc(1.5*h)',
                    x: 'calc(x-calc(0.25*w))',
                    y: 'calc(y-calc(0.25*h))'
                },
                buttonLabel: {
                    pointerEvents: 'none',
                    x: 'calc(w)',
                    y: 0,
                    textAnchor: 'middle',
                    textVerticalAnchor: 'middle'
                }
            }
        }, {
            markup: [{
                tagName: 'rect',
                selector: 'body',
            }, {
                tagName: 'text',
                selector: 'label'
            }, {
                tagName: 'rect',
                selector: 'button'
            }, {
                tagName: 'text',
                selector: 'buttonLabel'
            }]
        });

        var element = new CustomElement();
        element.position(250, 30);
        element.resize(100, 40);
        element.attr({
            label: {
                pointerEvents: 'none',
                visibility: 'visible',
                text: 'Element'
            },
            body: {
                cursor: 'default',
                visibility: 'visible'
            },
            button: {
                event: 'element:button:pointerdown',
                fill: 'orange',
                stroke: 'black',
                strokeWidth: 2
            },
            buttonLabel: {
                text: 'ï¼¿', // fullwidth underscore
                fill: 'black',
                fontSize: 8,
                fontWeight: 'bold'
            }
        });
        element.addTo(graph);

        var initialPos = null;
        paper.on('element:button:pointerdown', function (elementView, evt) {
            // stop any further actions with the element view (e.g. dragging)

            var model = elementView.model;
            initialPos = { x: evt.clientX, y: evt.clientY }
        });

        paper.on('element:button:pointermove', function (elementView, evt) {
            if (initialPosition) {
                var currentPosition = { x: evt.clientX, y: evt.clientY };
                var deltaX = currentPosition.x - initialPosition.x;
                var deltaY = currentPosition.y - initialPosition.y;
                var newWidth = rect.get('size').width + deltaX;
                var newHeight = rect.get('size').height + deltaY;
                rect.resize(newWidth, newHeight);
            }
        });



    </script>
</body>

</html>