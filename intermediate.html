<html>

<head>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.6.2/joint.css" />
</head>

<body>
    <div id="myholder"></div>

    <!---dependencies-->
    <script src="node_modules/jquery/dist/jquery.js"></script>
    <script src="node_modules/lodash/lodash.js"></script>
    <script src="node_modules/backbone/backbone.js"></script>
    <script src="node_modules/jointjs/dist/joint.js"></script>

    <script type="text/javascript">

        var namespace = joint.shapes
        var graph = new joint.dia.Graph({}, { cellNamespace: namespace });

        var paper = new joint.dia.Paper({
            el: document.getElementById('myholder'),
            model: graph,
            width: 1280,
            height: 720,
            gridSize: 10,
            drawGrid: true,
            background: {
                color: "rgba(154,255,0,0.3)"
            },
            cellViewNamespace: namespace,
            interactive: {
                linkMove: false,
                labelMove: true,
                arrowheadMove: true,
                vertexMove: true,
                vertexAdd: false,
                vertexRemove: false,
                useLinkTools: true
            },
            snapLabels: true
        });

        var source = new joint.shapes.standard.Rectangle();
        source.position(40, 40);
        source.resize(120, 60);
        source.attr({
            body: {
                fill: 'white',
                stroke: 'black',
                strokeWidth: 2
            },
            label: {
                text: 'Hello',
                fill: 'black'
            }
        });
        source.addTo(graph);


        var target = new joint.shapes.standard.Ellipse();
        target.position(440, 200);
        target.resize(120, 60);
        target.attr({
            body: {
                fill: 'white',
                stroke: 'black',
                strokeWidth: 2,
                rx: 60,
                ry: 30,
            },
            label: {
                text: 'World!',
                fill: 'black'
            }
        });
        target.addTo(graph);

        var link = new joint.shapes.standard.Link();
        link.source({ x: 10, y: 10 });
        link.target(target);
        link.vertices([
            new g.Point(120, 200)
            // new g.Point(200, 100)
        ])
        var verticesTool = new joint.linkTools.Vertices();
        var segmentsTool = new joint.linkTools.Segments();
        var boundaryTool = new joint.linkTools.Boundary();
        var sourceAnchorTool = new joint.linkTools.SourceAnchor();
        var targetAnchorTool = new joint.linkTools.TargetAnchor();
        var sourceArrowHeadTool = new joint.linkTools.SourceArrowhead();
        var targetArrowHeadTool = new joint.linkTools.TargetArrowhead();
        var toolsView = new joint.dia.ToolsView({
            tools: [verticesTool, segmentsTool, boundaryTool, sourceArrowHeadTool, targetArrowHeadTool]
        })

        paper.on("link:mouseenter", function (linkView) {
            linkView.addTools(toolsView);
        })

        paper.on("link:mouseleave", function (linkView) {
            linkView.removeTools(toolsView);
        })

        link.attr({
            line: {
                connection: true,
                fill: 'none',
                stroke: '#333333',
                strokeWidth: 2,
                strokeLinejoin: 'round',
                targetMarker: {
                    'type': 'path',
                    'd': 'M 10 -5 0 0 10 5 z'
                }
            },
            offsetLabelMarker: {
                atConnectionRatio: 0.66,
                textAnchor: 'middle',
                textVerticalAnchor: 'middle',
                text: 'ï¼Š',
                fill: 'red',
                stroke: 'black',
                strokeWidth: 1.2,
                fontSize: 30,
                fontWeight: 'bold'
            },
            offsetLabelPositiveConnector: {
                atConnectionRatio: 0.66,
                d: 'M 0 0 0 40',
                stroke: 'black',
                strokeDasharray: '5 5'
            },
            offsetLabelNegativeConnector: {
                atConnectionRatio: 0.66,
                d: 'M 0 0 0 -40',
                stroke: 'black',
                strokeDasharray: '5 5'
            },
            offsetLabelAbsoluteConnector: {
                atConnectionRatioIgnoreGradient: 0.66,
                d: 'M 0 0 -40 80',
                stroke: 'black',
                strokeDasharray: '5 5'
            }
        });
        link.appendLabel({
            attrs: {
                text: {
                    text: "Attribute 1"
                }
            },
            position: {
                distance: 0.25,
                offset: 40
            }
        })
        link.addTo(graph);
        link.appendLabel({
            markup: [
                {
                    tagName: 'circle',
                    selector: 'body'
                }, {
                    tagName: 'text',
                    selector: 'label'
                }, {
                    tagName: 'circle',
                    selector: 'asteriskBody'
                }, {
                    tagName: 'text',
                    selector: 'asterisk'
                }
            ],
            attrs: {
                label: {
                    text: '½',
                    fill: '#000000',
                    fontSize: 14,
                    textAnchor: 'middle',
                    yAlignment: 'middle',
                    pointerEvents: 'none'
                },
                body: {
                    ref: 'label',
                    fill: '#ffffff',
                    stroke: '#000000',
                    strokeWidth: 1,
                    r: 'calc(s)',
                    cx: 0,
                    cy: 0
                },
                asterisk: {
                    ref: 'label',
                    text: '＊',
                    fill: '#ff0000',
                    fontSize: 8,
                    textAnchor: 'middle',
                    textVerticalAnchor: 'middle',
                    pointerEvents: 'none',
                    x: 'calc(x+16.5)',
                    y: 'calc(y-2)'
                },
                asteriskBody: {
                    ref: 'asterisk',
                    fill: '#ffffff',
                    stroke: '#000000',
                    strokeWidth: 1,
                    r: 'calc(s)',
                    cx: 'calc(x+calc(0.5*w))',
                    cy: 'calc(y+calc(0.5*h))'
                }
            }
        });
    </script>


</body>

</html>